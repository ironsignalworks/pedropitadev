<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pedro Pita ‚Äî Win98 Desktop Portfolio</title>
<meta name="description" content="Lisbon-based web developer shipping performant, accessible web products and durable publishing pipelines ‚Äî now in a playful Windows 98 desktop." />
<meta name="theme-color" content="#008080" />
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<style>
  /* ===== Win98 Desktop Shell ‚Äî Single file, no deps ===== */
  :root{
    --desk-green:#008080;      /* classic teal */
    --title-blue:#000080;      /* win98 title bar */
    --title-blue-inactive:#5b7aa0;
    --gray-0:#c0c0c0;          /* 3D face */
    --gray-1:#dfdfdf;          /* light */
    --gray-2:#808080;          /* shadow */
    --black:#000; --white:#fff;
    --ink:#111;
    --accent:#0000ee;
    --bar-h:32px;
    --z-task:1000; --z-win:2000; --z-menu:3000;
  }
  html,body{height:100%}
  body{
    margin:0; background:var(--desk-green); color:var(--ink);
    font:14px/1.45 Tahoma, "MS Sans Serif", system-ui, -apple-system, Segoe UI, Arial, sans-serif;
    -webkit-font-smoothing:antialiased; overflow:hidden;
  }
  /* Retro pixel-edges */
  *{image-rendering:pixelated}

  /* ===== Desktop ===== */
  .desktop{
    position:fixed; inset:0; display:grid; grid-template-rows:1fr var(--bar-h);
    background: linear-gradient(0deg, rgba(0,0,0,.25), rgba(0,0,0,.25)), url('canyon1.jpg') center / cover no-repeat fixed;
  }

  /* Desktop icons */
  .icons{position:relative; padding:10px; overflow:auto}
  .icon{position:absolute; width:88px; text-align:center; color:#fff; cursor:default; user-select:none; appearance:none; background:transparent; border:0; padding:4px; margin:0}
.icon::-moz-focus-inner{border:0; padding:0}
  .icon .glyph{width:48px;height:48px;margin:0 auto 4px;display:grid;place-items:center;background:transparent;border:none;box-shadow:none;position:relative}
/* CSS-only Win98 folder icon */
.icon .glyph.folder{--fc:#f7d87a;--fd:#e1c464;--edge:#876d2b;}
.icon .glyph.folder::before{content:"";position:absolute;left:2px;top:6px;width:20px;height:9px;background:var(--fc);border:1px solid var(--edge);border-bottom:none;box-shadow:inset -1px -1px 0 rgba(0,0,0,.12), inset 1px 1px 0 rgba(255,255,255,.35)}
.icon .glyph.folder::after{content:"";position:absolute;left:2px;top:12px;width:44px;height:30px;background:linear-gradient(#f7d87a,#f1cf69);border:1px solid var(--edge);box-shadow:inset -1px -1px 0 rgba(0,0,0,.12), inset 1px 1px 0 rgba(255,255,255,.35)}
  .icon .label{display:inline-block; padding:2px 4px; background:rgba(0,0,128,.35); outline:1px solid rgba(255,255,255,.35); text-shadow:1px 1px 0 #000}
  .icon:focus .label, .icon.kbd .label{background:#000080; outline:1px solid #fff}

  /* ===== Windows ===== */
  .win{position:absolute; top:100px; left:140px; width:min(880px, 88vw); max-height:70vh; display:flex; flex-direction:column; background:var(--gray-0); border:2px solid var(--black); box-shadow:2px 2px 0 var(--gray-2), -1px -1px 0 var(--white);}
  .titlebar{height:28px; background:linear-gradient( to right, var(--title-blue), #1a2a8a ); color:#fff; display:flex; align-items:center; padding:0 6px; gap:6px; cursor:grab; user-select:none}
  .win.inactive .titlebar{background:linear-gradient(to right, var(--title-blue-inactive), #8aa8c7)}
  .titlebar .title{flex:1 1 auto; white-space:nowrap; overflow:hidden; text-overflow:ellipsis}
  .titlebar .ctl{display:flex; gap:2px}
  .btn3d{width:22px; height:20px; display:grid; place-items:center; background:var(--gray-0); border:2px solid var(--gray-2); border-right-color:var(--white); border-bottom-color:var(--white); cursor:pointer}
  .btn3d:active{border:2px solid var(--white); border-right-color:var(--gray-2); border-bottom-color:var(--gray-2)}
  .menubar{height:26px; background:var(--gray-0); display:flex; align-items:center; gap:16px; padding:0 8px; border-top:2px solid var(--white); border-left:2px solid var(--white); border-right:2px solid var(--gray-2); border-bottom:2px solid var(--gray-2)}
  .menubar .menuitem{padding:2px 6px; border:1px solid transparent; cursor:default}
  .menubar .menuitem:hover{background:var(--gray-1); border-color:var(--gray-2)}
  .content{flex:1 1 auto; overflow:auto; padding:10px; background:var(--gray-1); border-top:2px solid var(--white); border-left:2px solid var(--white);}
  .statusbar{height:22px; background:var(--gray-0); border-top:2px solid var(--white); display:flex; align-items:center; gap:8px; padding:0 6px}
  .resize{position:absolute; width:14px; height:14px; right:0; bottom:var(--bar-h); cursor:nwse-resize;}

  /* Bring to front */
  .win{z-index:var(--z-win)}

  /* ===== Taskbar ===== */
  .taskbar{height:var(--bar-h); background:var(--gray-0); display:flex; align-items:center; gap:8px; padding:4px; border-top:2px solid var(--white); box-shadow:0 -1px 0 var(--gray-2) inset}
  .start{display:inline-flex; align-items:center; gap:6px; padding:0 10px; height:24px; background:var(--gray-0); border:2px solid var(--gray-2); border-right-color:var(--white); border-bottom-color:var(--white); cursor:pointer; font-weight:600}
  .start:active{border:2px solid var(--white); border-right-color:var(--gray-2); border-bottom-color:var(--gray-2)}
  .tasklist{display:flex; gap:6px; align-items:center; overflow:auto; scrollbar-width:thin}
  .task{min-width:120px; max-width:240px; height:24px; display:inline-flex; align-items:center; gap:6px; padding:0 8px; background:var(--gray-0); border:2px solid var(--gray-2); border-right-color:var(--white); border-bottom-color:var(--white); cursor:pointer}
  .task.active{background:#e4e4e4}
  .clock{margin-left:auto; background:#e4e4e4; height:24px; padding:0 8px; display:inline-grid; place-items:center; border:2px solid var(--gray-2); border-right-color:var(--white); border-bottom-color:var(--white); font-variant-numeric:tabular-nums}

  /* ===== Portfolio content styling inside window ===== */
  .content h2{margin:0 0 8px; font:700 20px/1.2 Tahoma, "MS Sans Serif", sans-serif}
  .content h3{margin:8px 0 6px; font:700 16px/1.2 Tahoma, "MS Sans Serif", sans-serif}
  .stack{display:flex; flex-wrap:wrap; gap:4px}
  .stack span{padding:3px 6px; border:1px solid #bbb; background:#f6f6f6}
  .grid{display:grid; grid-template-columns:repeat(2, minmax(0,1fr)); gap:8px}
  .card{border:1px solid #b0b0b0; background:#efefef; padding:8px}
  .thumb{aspect-ratio:16/9; background:#c9c9c9; display:grid; place-items:center; font:600 12px/1 'JetBrains Mono', monospace; color:#333; margin-bottom:6px}
  .btn{display:inline-block; padding:4px 8px; border:1px solid #888; background:#eee; text-decoration:none; color:#000}
  .btn:hover{background:#fff}

  .ascii-pad{width:100%;height:48vh;min-height:260px;resize:vertical;border:1px solid #888;background:#111;color:#0f0;font:12px/1.25 'JetBrains Mono',ui-monospace,monospace;white-space:pre;overflow:auto;padding:8px}
.ascii-actions{display:flex;gap:6px;margin:6px 0}
/* ===== Context menu (right click) ===== */
  .ctx{position:absolute; background:#fff; border:1px solid #000; box-shadow:4px 4px 0 #0003; min-width:160px; display:none; flex-direction:column; z-index:var(--z-menu)}
  .ctx button{appearance:none; border:0; background:#fff; text-align:left; padding:6px 10px; font:13px Tahoma}
  .ctx button:hover{background:#cce5ff}

  /* A11y helpers */
  .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
</style>
</head>
<body>
<div class="desktop" role="application" aria-label="Windows 98 desktop">
  <div class="icons" id="desktopIcons" aria-label="Desktop icons">
    <!-- Icons will be positioned via data-x/y; change labels or add more as needed -->
    <button class="icon" data-app="about" style="left:14px;top:14px" aria-label="Open About">
      <div class="glyph" aria-hidden="true">üíæ</div>
      <span class="label">About Me</span>
    </button>
    <button class="icon" data-app="work" style="left:14px;top:120px" aria-label="Open Work">
      <div class="glyph folder" aria-hidden="true"></div>
      <span class="label">Client Work</span>
    </button>
    <button class="icon" data-app="projects" style="left:14px;top:226px" aria-label="Open Projects">
      <div class="glyph" aria-hidden="true">üïπÔ∏è</div>
      <span class="label">Games & Apps</span>
    </button>
    <button class="icon" data-app="contact" style="left:14px;top:332px" aria-label="Open Contact">
      <div class="glyph" aria-hidden="true">üìß</div>
      <span class="label">Contact</span>
    </button>
    <button class="icon" data-app="sites" style="left:14px;top:438px" aria-label="Open Sites">
      <div class="glyph" aria-hidden="true">üåê</div>
      <span class="label">Sites</span>
    </button>
    <button class="icon" data-app="kommando" style="left:14px;top:544px" aria-label="Open KOMMANDO">
      <div class="glyph folder" aria-hidden="true"></div>
      <span class="label">KOMMANDO</span>
    </button>
  </div>

  <!-- Windows will be injected here -->

  <!-- Context menu -->
  <div class="ctx" id="ctxMenu" role="menu">
    <button data-cmd="new">New‚Ä¶</button>
    <button data-cmd="arrange">Auto Arrange Icons</button>
    <button data-cmd="theme">Toggle Theme Color</button>
  </div>

  <!-- Taskbar -->
  <div class="taskbar" aria-label="Taskbar">
    <button class="start" id="startBtn" aria-haspopup="true" aria-expanded="false">ü™ü Start</button>
    <div class="tasklist" id="tasklist" role="tablist" aria-label="Open windows"></div>
    <time class="clock" id="clock" aria-live="polite"></time>
  </div>
</div>

<!-- ===== App Content Templates (lifted from your portfolio) ===== -->
<template id="tpl-about">
  <section>
    <h2>About</h2>
    <div class="stack" aria-label="Core skills">
      <span>JavaScript</span><span>React</span><span>Next.js</span><span>TypeScript</span><span>Tailwind</span><span>Vercel</span><span>Node</span>
    </div>
    <p>I design and ship lean, high-performance web products‚Äîaccessible, fast, and easy to maintain. From content models to APIs and deployment, I keep the stack invisible and the outcome clear.</p>
    <div class="grid">
      <article class="card">
        <h3>What I‚Äôm good at</h3>
        <p>Front‚Äëend feature work, performant layouts, API integrations, and tidy content systems.</p>
      </article>
      <article class="card">
        <h3>Availability</h3>
        <p>Open to front‚Äëend/full‚Äëstack roles and selected client work.</p>
        <p><a class="btn" href="mailto:hello@pedropita.dev">Email</a> <a class="btn" href="https://www.linkedin.com/in/pedropita" target="_blank" rel="noopener">LinkedIn</a></p>
      </article>
    </div>
  </section>
</template>

<template id="tpl-work">
  <section>
    <h2>Selected Client Work</h2>
    <div class="stack"><span>Next.js</span><span>React</span><span>Tailwind</span><span>Vercel</span><span>Figma</span><span>REST</span></div>
    <div class="grid">
      <article class="card">
        <div class="thumb">Mojobyte</div>
        <h3>Mojobyte ‚Äî Web Dev Company</h3>
        <p>Clear service pages and pricing. SEO‚Äëready, fast, easy to maintain.</p>
        <p><a class="btn" href="https://mojobyte.com" target="_blank" rel="noopener">Visit</a></p>
      </article>
      <article class="card">
        <div class="thumb">Iron Signal Works</div>
        <h3>Iron Signal Works ‚Äî Indie Game Studio</h3>
        <p>Lean studio site with media embeds and simple publishing flow.</p>
        <p><a class="btn" href="https://ironsignalworks.com" target="_blank" rel="noopener">Visit</a></p>
      </article>
      <article class="card">
        <div class="thumb">NovaScript AI</div>
        <h3>NovaScript AI ‚Äî Corporate Website</h3>
        <p>Direct copy, clean IA, and sensible on‚Äëpage SEO.</p>
        <p><a class="btn" href="https://novascript.eu" target="_blank" rel="noopener">Visit</a></p>
      </article>
      <article class="card">
        <div class="thumb">Gamma Threads</div>
        <h3>Gamma Threads ‚Äî Clothing + Game</h3>
        <p>Brand page with embedded mini‚Äëgame and simple merch pipeline.</p>
        <p><a class="btn" href="https://gamma-threads.com" target="_blank" rel="noopener">Visit</a></p>
      </article>
    </div>
  </section>
</template>

<template id="tpl-projects">
  <section>
    <h2>Selected Games & Apps</h2>
    <h3>Games</h3>
    <div class="grid">
      <article class="card">
        <div class="thumb">Jungle Siege</div>
        <h3>Jungle Siege (in progress)</h3>
        <p>Top‚Äëdown action with custom HUD, bosses, cinematic intros.</p>
        <p><a class="btn" href="https://ironsignalworks.com/games/jungle-siege" target="_blank" rel="noopener">Prototype</a></p>
      </article>
      <article class="card">
        <div class="thumb">Reaktor 404</div>
        <h3>Reaktor 404</h3>
        <p>Tiny arcade embed for the apparel site.</p>
        <p><a class="btn" href="https://ironsignalworks.com/games/reaktor-404" target="_blank" rel="noopener">Play</a></p>
      </article>
      <article class="card">
        <div class="thumb">Spam Invaders</div>
        <h3>Spam Invaders</h3>
        <p>Win98‚Äëflavored Space Invaders‚Äîjust for fun.</p>
        <p><a class="btn" href="https://ironsignalworks.com/games/spaminvaders" target="_blank" rel="noopener">Play</a></p>
      </article>
      <article class="card">
        <div class="thumb">Depthcharge</div>
        <h3>Depthcharge</h3>
        <p>Minimalist naval arcade‚Äîtight loop, crunchy feedback.</p>
        <p><a class="btn" href="https://ironsignalworks.com/games/depthcharge" target="_blank" rel="noopener">Play</a></p>
      </article>
    </div>
    <h3>Apps</h3>
    <div class="grid">
      <article class="card">
        <div class="thumb">Radiofry</div>
        <h3>Radiofry ‚Äî DAW</h3>
        <p>Browser DAW experiments with offline render flow.</p>
      </article>
      <article class="card">
        <div class="thumb">AI Assistant</div>
        <h3>AI Assistant (in prod)</h3>
        <p>Internal assistant with tools and memory.</p>
      </article>
    </div>
  </section>
</template>

<template id="tpl-contact">
  <section>
    <h2>Contact</h2>
    <p>Best way to reach me: <a href="mailto:hello@pedropita.dev">hello@pedropita.dev</a>. I reply fast.</p>
    <p>
      <a class="btn" href="mailto:hello@pedropita.dev">Email</a>
      <a class="btn" href="https://www.linkedin.com/in/pedropita" target="_blank" rel="noopener">LinkedIn</a>
      <a class="btn" href="https://github.com/ironsignalworks" target="_blank" rel="noopener">GitHub</a>
      <a class="btn" href="https://mojobyte.com" target="_blank" rel="noopener">Mojobyte</a>
      <a class="btn" href="https://ironsignalworks.com" target="_blank" rel="noopener">ISW</a>
    </p>
  </section>
</template>

<template id="tpl-sites">
  <section>
    <h2>Sites</h2>
    <ul>
      <li><a href="https://pedropita.dev" target="_blank" rel="noopener">pedropita.dev</a></li>
      <li><a href="https://ironsignalworks.com" target="_blank" rel="noopener">ironsignalworks.com</a></li>
      <li><a href="https://mojobyte.com" target="_blank" rel="noopener">mojobyte.com</a></li>
      <li><a href="https://gamma-threads.com" target="_blank" rel="noopener">gamma-threads.com</a></li>
      <li><a href="https://novascript.eu" target="_blank" rel="noopener">novascript.eu</a></li>
      <li><a href="https://deadgravel.com" target="_blank" rel="noopener">deadgravel.com</a></li>
    </ul>
  </section>
</template>

<template id="tpl-kommando">
  <section>
    <h2>KOMMANDO</h2>
    <p>Drop your game build here later. For now this is a placeholder window with a mount point.</p>
    <div id="kommando-mount" style="height:50vh;min-height:260px;border:1px dashed #888;background:#111;color:#9ef;padding:8px;display:grid;place-items:center;">
      <div>
        <p style="margin:0 0 6px;font-weight:600">/games/kommando ‚Äî placeholder</p>
        <p style="margin:0">When ready, replace this with your canvas/app iframe or injected script.</p>
      </div>
    </div>
  </section>
</template>
<script>
(function(){
  const $ = sel => document.querySelector(sel);
  const $$ = sel => Array.from(document.querySelectorAll(sel));
  const desktop = document.body;
  const tasklist = $('#tasklist');
  const clock = $('#clock');
  const ctxMenu = $('#ctxMenu');

  // Clock
  const fmt = v => String(v).padStart(2,'0');
  const tick = () => { const d=new Date(); clock.textContent = `${fmt(d.getHours())}:${fmt(d.getMinutes())}`; };
  tick(); setInterval(tick, 15_000);

  // Z layering
  let zTop = 2000; const raise = el => { zTop+=2; el.style.zIndex = zTop; $$('.win').forEach(w=>w.classList.toggle('inactive', w!==el)); };

  // Drag helper (titlebar + icons)
  function drag(el, startEv, onMove){
    startEv.preventDefault();
    const rect = el.getBoundingClientRect();
    const ox = (startEv.clientX||startEv.touches?.[0].clientX) - rect.left;
    const oy = (startEv.clientY||startEv.touches?.[0].clientY) - rect.top;
    const onpointermove = (ev)=>{
      const x = (ev.clientX||ev.touches?.[0].clientX) - ox;
      const y = (ev.clientY||ev.touches?.[0].clientY) - oy;
      onMove(x,y,ev);
    };
    const stop = ()=>{ window.removeEventListener('pointermove',onpointermove); window.removeEventListener('pointerup',stop); window.removeEventListener('touchmove',onpointermove); window.removeEventListener('touchend',stop); };
    window.addEventListener('pointermove',onpointermove); window.addEventListener('pointerup',stop);
    window.addEventListener('touchmove',onpointermove,{passive:false}); window.addEventListener('touchend',stop);
  }

  // Create a window
  function openApp(id, title){
    // If exists, focus
    const existing = $(`.win[data-app="${id}"]`);
    if(existing){ raise(existing); existing.style.display='flex'; activateTask(existing); return existing; }

    const tpl = $(`#tpl-${id}`); if(!tpl){ alert('Missing template for '+id); return; }
    const win = document.createElement('section');
    win.className = 'win';
    win.dataset.app = id;
    win.style.left = (120 + Math.random()*80) + 'px';
    win.style.top  = (60 + Math.random()*60) + 'px';

    win.innerHTML = `
      <div class="titlebar" tabindex="0" role="toolbar" aria-label="Window title bar">
        <span class="title">${title}</span>
        <div class="ctl">
          <button class="btn3d" data-act="min" title="Minimize" aria-label="Minimize">_</button>
          <button class="btn3d" data-act="max" title="Maximize" aria-label="Maximize">‚ñ¢</button>
          <button class="btn3d" data-act="close" title="Close" aria-label="Close">‚úï</button>
        </div>
      </div>
      <div class="menubar" role="menubar">
        <div class="menuitem" role="menuitem">File</div>
        <div class="menuitem" role="menuitem">Edit</div>
        <div class="menuitem" role="menuitem">View</div>
        <div class="menuitem" role="menuitem">Help</div>
      </div>
      <div class="content" role="document"></div>
      <div class="statusbar" role="status">Ready</div>
    `;

    document.querySelector('.desktop').appendChild(win);
    const content = win.querySelector('.content');
    content.appendChild(tpl.content.cloneNode(true));
    raise(win);

    // Drag by titlebar
    const tb = win.querySelector('.titlebar');
    tb.addEventListener('pointerdown', ev=> drag(win, ev, (x,y)=>{
      const maxX = innerWidth - win.offsetWidth - 2; const maxY = innerHeight - win.offsetHeight - 34;
      win.style.left = Math.max(0, Math.min(maxX, x)) + 'px';
      win.style.top = Math.max(0, Math.min(maxY, y)) + 'px';
    }));

    // Controls
    win.addEventListener('click', (e)=>{
      const act = e.target.closest('.btn3d')?.dataset.act;
      if(!act) return;
      if(act==='close'){ closeWin(win); }
      if(act==='min'){ minimizeWin(win); }
      if(act==='max'){ toggleMax(win); }
    });

    // Focus on click
    win.addEventListener('mousedown', ()=> raise(win));

    // Task button
    addTaskButton(win, title);
    return win;
  }

  function closeWin(win){
    const id = win.dataset.app; const task = $(`.task[data-app="${id}"]`); if(task) task.remove();
    win.remove();
  }
  function minimizeWin(win){
    const id = win.dataset.app; const task = $(`.task[data-app="${id}"]`);
    win.style.display = 'none'; if(task) task.classList.remove('active');
  }
  function toggleMax(win){
    if(win.dataset.max!=='1'){
      win.dataset.prev = JSON.stringify({left:win.style.left, top:win.style.top, w:win.style.width, h:win.style.height});
      win.style.left = '0px'; win.style.top='0px'; win.style.width = (innerWidth-2)+'px'; win.style.height = (innerHeight-34)+'px';
      win.dataset.max='1';
    }else{
      const p = JSON.parse(win.dataset.prev||'{}');
      win.style.left = p.left||'120px'; win.style.top = p.top||'60px';
      win.style.width = p.w||'min(880px,88vw)'; win.style.height = p.h||'';
      delete win.dataset.max; delete win.dataset.prev;
    }
  }

  function addTaskButton(win, title){
    const id = win.dataset.app;
    const btn = document.createElement('button');
    btn.className = 'task active'; btn.dataset.app = id; btn.setAttribute('role','tab');
    btn.innerHTML = `ü™ü <span>${title}</span>`;
    tasklist.appendChild(btn);
    btn.addEventListener('click', ()=>{
      const visible = win.style.display !== 'none';
      if(!visible){ win.style.display='flex'; }
      raise(win); activateTask(win);
    });
    activateTask(win);
  }
  function activateTask(win){
    const id = win.dataset.app; $$('.task').forEach(t=>t.classList.toggle('active', t.dataset.app===id));
  }

  // Desktop icons: double‚Äëclick to open + draggable
  const openMap = {
    about:['About Me','about'],
    work:['Client Work','work'],
    projects:['Games & Apps','projects'],
    contact:['Contact','contact'],
    sites:['Sites','sites'],
    kommando:['KOMMANDO','kommando']
  };

  $('#desktopIcons').addEventListener('dblclick', (e)=>{
    const ic = e.target.closest('.icon'); if(!ic) return;
    const app = ic.dataset.app; const [title,id] = openMap[app]||[app,app];
    openApp(id, title);
  });

  // Make icons draggable
  $$('.icon').forEach(ic=>{
    ic.addEventListener('pointerdown', ev=>{
      drag(ic, ev, (x,y)=>{ ic.style.left=Math.max(4,Math.min(innerWidth-96,x))+'px'; ic.style.top=Math.max(4,Math.min(innerHeight-96-34,y))+'px'; });
    });
  });

  // Right‚Äëclick context menu
  desktop.addEventListener('contextmenu', (e)=>{
    e.preventDefault();
    ctxMenu.style.display='flex'; ctxMenu.style.left=e.clientX+'px'; ctxMenu.style.top=e.clientY+'px';
  });
  window.addEventListener('click', ()=> ctxMenu.style.display='none');
  ctxMenu.addEventListener('click', (e)=>{
    const cmd = e.target.dataset.cmd; if(!cmd) return;
    if(cmd==='arrange'){ autoArrange(); }
    if(cmd==='theme'){ toggleTheme(); }
    if(cmd==='new'){ alert('üòâ Coming soon: New ‚Üí Shortcut / Folder / Text Document'); }
  });

  function autoArrange(){
    const pad=12, colW=96, rowH=106; let col=0,row=0; const maxRows=Math.floor((innerHeight-34-20)/rowH);
    $$('.icon').forEach(ic=>{ ic.style.left=(pad+col*colW)+'px'; ic.style.top=(pad+row*rowH)+'px'; row++; if(row>=maxRows){ row=0; col++; } });
  }
  function toggleTheme(){
    const teal = getComputedStyle(document.documentElement).getPropertyValue('--desk-green').trim();
    document.documentElement.style.setProperty('--desk-green', teal==='#008080' ? '#004a7f' : '#008080');
  }

  // Start button (for fun, toggles About)
  $('#startBtn').addEventListener('click', ()=>{
    openApp('about','About Me');
  });

  // Keyboard: Enter/Space activates focused icon
  $('#desktopIcons').addEventListener('keydown', (e)=>{
    if(e.key==='Enter' || e.key===' '){ const ic=document.activeElement.closest('.icon'); if(ic){ const [title,id]=openMap[ic.dataset.app]||[ic.dataset.app,ic.dataset.app]; openApp(id,title); } }
  });

  // First focus to first icon for a11y
  const firstIcon = $('.icon'); if(firstIcon) firstIcon.focus();
})();
</script>
</body>
</html>
